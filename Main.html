<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Bytrox â€” Grand Admin</title>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js";
import { getDatabase, ref, set, get, remove } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-database.js";

const app = initializeApp({
  apiKey:"AIzaSyB1_XCbC777hKwxlilhMeq5Hpty1dvDT1I",
  authDomain:"giper-8fd92.firebaseapp.com",
  databaseURL:"https://giper-8fd92-default-rtdb.firebaseio.com",
  projectId:"giper-8fd92",
  storageBucket:"giper-8fd92.firebasestorage.app",
  messagingSenderId:"485740337398",
  appId:"1:485740337398:web:ab901fd4f28219ea5834d7"
});
const db = getDatabase(app);

const uidGen=()=>[8,4,4,4,12].map(n=>Array.from({length:n},()=> "abcdef0123456789"[Math.floor(Math.random()*16)]).join("")).join("-");

async function loadKeys(){
  const snap = await get(ref(db,"admins/"));
  const box = document.getElementById("keysGrid");
  box.innerHTML = "";
  let total = 0;
  if(snap.exists()){
    const data = snap.val();
    total = Object.keys(data).length;
    Object.entries(data).sort((a,b)=>(b[1].created_at||"").localeCompare(a[1].created_at||"")).forEach(([uid,info])=>{
      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        <div class="card-header">
          <div class="uid">${uid}</div>
          <div class="badge">${info.time}</div>
        </div>
        <div class="card-body">
          <div class="title">${info.name}</div>
          <div class="meta">${new Date(info.created_at||Date.now()).toLocaleString()}</div>
        </div>
        <div class="card-actions">
          <button class="action ghost open">Open</button>
          <button class="action ghost copy">Copy</button>
          <button class="action danger del">Delete</button>
        </div>
      `;
      card.querySelector(".copy").onclick = ()=>navigator.clipboard.writeText(uid);
      card.querySelector(".del").onclick = async ()=>{ if(confirm("Delete?")){ await remove(ref(db,"admins/"+uid)); loadKeys(); } };
      card.querySelector(".open").onclick = ()=>openModal(uid,info);
      box.appendChild(card);
    });
  }
  document.getElementById("total").textContent = total;
  document.getElementById("count").textContent = box.childElementCount;
}

function openModal(uid,info){
  const m = document.getElementById("modal");
  m.querySelector(".m-uid").textContent = uid;
  m.querySelector(".m-name").textContent = info.name;
  m.querySelector(".m-time").textContent = info.time;
  document.getElementById("modalCopy").onclick = ()=>navigator.clipboard.writeText(uid);
  document.getElementById("modalDelete").onclick = async ()=>{ if(confirm("Delete?")){ await remove(ref(db,"admins/"+uid)); closeModal(); loadKeys(); } };
  m.classList.add("visible");
  document.body.style.overflow = "hidden";
}

function closeModal(){
  document.getElementById("modal").classList.remove("visible");
  document.body.style.overflow = "";
}

window.addEventListener("load", ()=>{
  const form = document.getElementById("createForm");
  form.onsubmit = async e=>{
    e.preventDefault();
    const uid = uidGen();
    const name = document.getElementById("name").value.trim();
    const time = document.getElementById("time").value.trim();
    if(!name || !time) return;
    await set(ref(db,"admins/"+uid), {
      name: `${name} [${time}]`,
      time,
      created_at: new Date().toISOString()
    });
    form.reset();
    loadKeys();
  };
  document.getElementById("copyAll").onclick = ()=>{ const all=[...document.querySelectorAll(".uid")].map(x=>x.textContent).join("\n"); navigator.clipboard.writeText(all); };
  document.getElementById("deleteAll").onclick = async ()=>{ if(confirm("Delete all?")){ await remove(ref(db,"admins/")); loadKeys(); } };
  document.getElementById("modalClose").onclick = closeModal;
  document.getElementById("modalBackdrop").onclick = closeModal;
  loadKeys();
});
</script>

<style>
:root{
  --bg1:#08111c;
  --bg2:#0c1a2a;
  --card:#111a25;
  --accent:#60f0c0;
  --accent2:#7860ff;
  --muted:#9ca8b3;
  --danger:#ff6b6b;
}
html,body{margin:0;padding:0;height:100%;font-family:sans-serif;background:linear-gradient(180deg,var(--bg1),var(--bg2));color:#eef7f6}
.topbar{display:flex;justify-content:space-between;padding:18px 20px 10px}
.brand{display:flex;align-items:center;gap:10px}
.logo{width:48px;height:48px;border-radius:12px;display:grid;place-items:center;background:linear-gradient(135deg,var(--accent2),var(--accent));font-weight:700;font-size:18px;color:#012}
.title{font-size:18px;font-weight:700}
.controls{display:flex;gap:8px}
.statCard{background:rgba(255,255,255,0.04);padding:6px 10px;border-radius:10px;font-size:12px;text-align:center}
.num{font-size:16px;font-weight:700;color:var(--accent)}
.container{max-width:1000px;margin:14px auto;padding:0 14px 100px}
.hero{background:rgba(255,255,255,0.02);padding:16px;border-radius:14px;display:flex;gap:14px;border:1px solid rgba(255,255,255,0.02)}
.hero-right{width:260px;display:flex;flex-direction:column;gap:8px}
.input{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:10px;border-radius:10px;color:#fff;font-size:14px}
.btnPrimary{background:linear-gradient(90deg,var(--accent2),var(--accent));padding:10px;border:none;border-radius:10px;color:#012;font-weight:700;cursor:pointer}
.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px 10px;border-radius:10px;color:var(--muted);cursor:pointer}
.keys{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:14px}
.card{background:rgba(255,255,255,0.02);padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);display:flex;flex-direction:column;gap:10px}
.card-header{display:flex;justify-content:space-between}
.uid{font-size:11px;color:var(--muted);word-break:break-all}
.badge{background:rgba(123,97,255,0.12);padding:4px 8px;border-radius:8px;font-size:11px;font-weight:700;color:var(--accent2)}
.title{font-weight:700;font-size:14px}
.meta{font-size:11px;color:var(--muted)}
.card-actions{display:flex;gap:6px;justify-content:flex-end}
.action{padding:6px 8px;border-radius:8px;font-size:12px;cursor:pointer;border:none}
.action.danger{background:linear-gradient(90deg,#ff8d8d,#ff6b6b);color:#fff}
.fab{position:fixed;right:18px;bottom:80px;background:linear-gradient(135deg,var(--accent2),var(--accent));width:56px;height:56px;border-radius:14px;display:grid;place-items:center;color:#012;font-size:20px;border:none;cursor:pointer}
.modal{position:fixed;inset:0;display:grid;place-items:center;visibility:hidden;opacity:0;transition:.15s}
.modal.visible{visibility:visible;opacity:1}
.modalBackdrop{position:absolute;inset:0;background:rgba(0,0,0,0.6)}
.modalPanel{position:relative;z-index:2;background:#0a1522;padding:16px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);width:92%;max-width:420px}
.modalRow{display:flex;justify-content:space-between;color:var(--muted);padding:6px 0;border-bottom:1px solid rgba(255,255,255,0.03);font-size:13px}
.mActions{margin-top:10px;display:flex;justify-content:flex-end;gap:8px}
footer{position:fixed;left:0;right:0;bottom:0;height:60px;background:rgba(0,0,0,0.2);display:flex;align-items:center;justify-content:center;color:var(--muted);font-size:13px}
@media(max-width:980px){.keys{grid-template-columns:repeat(2,1fr)}}
@media(max-width:640px){.keys{grid-template-columns:1fr}.hero{flex-direction:column}}
</style>
</head>

<body>
  <div class="topbar">
    <div class="brand">
      <div class="logo">B</div>
      <div class="title">Bytrox Admin</div>
    </div>
    <div class="controls">
      <div class="statCard"><div>Total</div><div class="num" id="total">0</div></div>
      <div class="statCard"><div>Loaded</div><div class="num" id="count">0</div></div>
    </div>
  </div>

  <div class="container">
    <div class="hero">
      <div style="flex:1">
        <div style="font-size:16px;font-weight:700">Create keys</div>
        <div class="toolbar" style="margin-top:8px;display:flex;gap:8px">
          <button id="copyAll" class="ghost">Copy All</button>
          <button id="deleteAll" class="ghost">Delete All</button>
        </div>
      </div>
      <div class="hero-right">
        <form id="createForm">
          <input id="name" class="input" placeholder="name" required />
          <input id="time" class="input" placeholder="time" required />
          <button type="submit" class="btnPrimary">Create</button>
        </form>
      </div>
    </div>

    <div class="keysHeader" style="margin-top:14px;font-size:14px;color:var(--muted)">Newest first</div>
    <div id="keysGrid" class="keys"></div>
  </div>

  <button class="fab">+</button>

  <div id="modal" class="modal">
    <div id="modalBackdrop" class="modalBackdrop"></div>
    <div class="modalPanel">
      <div style="display:flex;justify-content:space-between;font-weight:700;margin-bottom:6px">
        <div>Details</div>
        <button id="modalClose" class="ghost">Close</button>
      </div>
      <div class="modalRow"><div>UID</div><div class="m-uid"></div></div>
      <div class="modalRow"><div>Name</div><div class="m-name"></div></div>
      <div class="modalRow"><div>Time</div><div class="m-time"></div></div>
      <div class="mActions">
        <button id="modalCopy" class="ghost">Copy</button>
        <button id="modalDelete" class="action danger">Delete</button>
      </div>
    </div>
  </div>

  <footer>Bytrox</footer>
</body>
</html>
